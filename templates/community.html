{% extends "layout.html" %}
{% block body %}

<h1>{{ com.title }}</h1>
<input align="right" type="button" value="Create new post" id="show">
{% if is_subbed %}
<form class="harmless-form" action="{{ url_for('community.unsubscribecommunity') }}" method="post">
    <input type="hidden" name="id" value="{{ com.id }}"/>
    <button class=ghost-button type="submit">Unsubscribe</button>
</form>
{% endif %}
<div id="content">
    {% for post in posts %}
    <div>
        <article class="post">
            <header>
                <div>
                    <h1>{{ post.title }}</h1>
                    <div class="about">by {{ post.author}} on {{ post.creation_date.strftime('%Y-%m-%d') }}</div>
                </div>
            </header>
            <div id="post{{ post.id}}" class="body">
                {{ post.html_page| safe}}
            </div>
            <hr>
        </article>
        <form action="{{ url_for('userService.likepost') }}" method="post">
            <input type="hidden" name="postid" value="{{ post.id }}"/>
            <button class="like-button" type="submit"><i class="fa fa-heart-o" aria-hidden="true"></i></button>
        </form>

        <hr>
        <p>Comments</p>
        {% for comment in post.post_comments %}
        <p>{{comment.text}}</p>
    </div>
    {% endfor %}

</div>
<form action="{{ url_for('userService.addcomment') }}" method="post">
    <input type="hidden" name="postid" value="{{ post.id }}"/>
    <input type="text" name="text">
    <button type="submit">Comment</button>
</form>
{% endfor %}

<dialog background-color=rgba(0, 0, 0, 0.8)>
    <p>Enter title for your post.</p>
    <p> If you have html page, you should attach it below.</p>
    <form class="harmless-form" action="{{ url_for('create_post.createposts') }}" method=post
          enctype="multipart/form-data">
        <p>Title:</p>
        <input type=text name=title required>
        <p>Load html page:</p>
        <input type="file" name="html_page" enctype="multipart/form-data">
        <br>
        <input type=submit value=Create>
    </form>
    <button id="close">Cancel</button>
</dialog>

<script type=text/javascript>
var dialog = document.querySelector('dialog');
document.querySelector('#show').onclick = function() {
  dialog.showModal();;
};
document.querySelector('#close').onclick = function() {
  dialog.close();
};




</script>
{% endblock %}